<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Cat Products Store</title>

    <link href="https://fonts.googleapis.com/css?family=Cherry+Swash|Raleway" rel="stylesheet">
    <script src="./product_data.js" type="text/javascript"></script>
    <link href="products-style.css" rel="stylesheet">

</head>
<form name="quantity_form" action="./invoice.html" method="POST">
<body>
    <script>
        // from lab 13 order_page.html, this is so that we can get an error message when an in valid quantity is entered in the text box 
        function isNonNegInt(queryString, returnErrors = false) {
            errors = []; // assume no errors at first
            if (Number(queryString) != queryString) {
                errors.push('Not a number!'); // Check if string is a number value
            } else {
                if (queryString < 0) errors.push('Negative value!'); // Check if it is non-negative
                if (parseInt(queryString) != queryString) errors.push('Not an integer!'); // Check that it is an integer
            }
            if (returnErrors) {
                return errors;
            } else if (errors.length == 0) {
                return true;
            } else {
                return false;
            }
        }
        // checks that the quantity entered in text box is within the parameters set / lab 13 order_page.html
        function checkQuantityTextbox(the_object) {
            let input_string = the_object.value;
            let error_array = isNonNegInt(input_string, true);
            if (error_array.length == 0) {
                qty_textbox_message.innerHTML = input_string;
            } else {
                qty_textbox_message.innerHTML = error_array.join("; ");
            }
        }
        // this is so that when the error occurs this say that it will go to the document location, message pop up is link from the server.js 
        let params = (new URL(document.location)).searchParams;
        // Check for an error and if so, pop up an alert to the user
        if (json.parse(params.get("error"))) { // alert is marked as error 
            let err_msg = params.get("error");
            alert(err_msg); // error message is pulled within the sever.js 
        } if (error_msg != "") { // IR4 REQUIRED if error is there an change the button to what error's value message coming from server.js
    document.write(`<input type="submit" value=${error}>`);
        } else {
    document.write(`<input type="submit" value="Check Out!">`); // if no errors then have button be check out!
    };

    </script>
    <header>
        <h1>Essentials to make your cat happy!</h1>
    </header>
    <div>
        <main>
           <script>
           for(i = 0; i < products.length; i++) {
           document.write(`
            <section class="item">
                <h2>${products[i].name}</h2>
                <h4>Total Sold: ${products[i].total_sold}</h4>
                <h5>Quantity Desired</h5>
                <input type="text" name="quantity${i}" id="quantity${i}_label">
                <h6>Available Stock: ${products[i].quantity_available}</h6>
                <p>$${products[i].price}</p>
                <img src=${products[i].image}>
            </section>
            `)
        };
        </script>
        </main>
    </div>
    <footer>
        <h1>
            <input type="submit" value="Check Out!">
        </h1>
    </footer>
</form>
</body>

</html>
